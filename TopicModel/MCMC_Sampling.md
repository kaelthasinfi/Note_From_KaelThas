<h1>
    MCMC采样
</h1>

>Written by Native.S1mple

对于马尔可夫链分布$\pi$的**细致平稳条件**，一般情况下，目标平稳分布$\pi(x)$和某一个马尔可夫链状态转移方程$Q$不满足细致平稳条件，即$\Rightarrow \pi(i)Q(i,j)\neq\pi(j)Q(j,i)$
我们可以对上式子进行一个改造，是细致平稳条件成立，引入一个$\alpha(i,j)$使上式子成立即可，$\pi(i)Q(i,j)\alpha(i,j)=\pi(j)Q(j,i)\alpha(j,i)$问题是什么样的$\alpha(i,j)$可以使得等式成立呢？其实只要满足$\alpha(i,j)=\pi(i,j)Q(j,i) \And \alpha(j,i)=\pi(i)Q(i,j)$
这样我们就得到了分布$\pi(x)$对应的马尔可夫链状态转移矩阵$P$，满足$P(i,j)=Q(i,j)\alpha(i,j)$
也就是目标矩阵可以通过任意一个马尔可夫状态转移矩阵乘以$\alpha(i,j)$得到，$\alpha(i,j)$我们一般称为**接受率**，值一般在$[0,1]$之间，可以理解为一个概率值。即目标矩阵$P$可以通过任意一个马尔可夫状态转移矩阵$Q$以一定的接受率获得。这是一个常见的马尔可夫链状态转移矩阵$Q$通过一定的接受-拒绝概率得到目标转移矩阵$P$。
**MCMC采样过程**:
$1)$输入$Q$,平稳分布$\pi(x)$,设定状态转移次数阈值$n_1$，需要的样本个数$n_2$。
$2)$从任意简单概率分布采样得到初始状态值$x_0$
$3)for\quad t=0\quad to \quad n_1+n_2-1$
$\quad a)$从条件概率分布$Q(x|x_t)$中采样得到样本$x_*$
$\quad b)$从均匀分布采样$u$~$uniform[0,1]$
$\quad c)$如果$u<\alpha(x_t,x_*)=\pi(x_*)Q(x_*,x_t)$则接受转移$x_t\rightarrow x_*即x_{t+1}=x_*$
$\quad d)$否则不接受$x_{t+1}=x_t$
样本集$(x_{n_1},x_{n_1+1},……,x_{n_1+n_2-1})$即为我们需要的平稳分布对应的样本集。
问题：$c$步骤由于$\alpha(x_t,x_*)$(接受率)可能非常小，比如0.1，导致我们大部分的采样值均被拒绝，采样效率非常低，这要求$n_1$非常大。